{"ast":null,"code":"import { catchError, map } from 'rxjs/operators';\nimport { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../savings/savings.service\";\nimport * as i3 from \"src/app/shared/services/notify.service\";\nexport class OperationsService {\n  constructor(http, savingsService, notifyService) {\n    this.http = http;\n    this.savingsService = savingsService;\n    this.notifyService = notifyService;\n    this.url = environment.apiUrl + 'operations/';\n  }\n  create(operation) {\n    return this.http.post(this.url, operation).pipe(map(operation => {\n      this.notifyService.showSuccess('Operation successfully created');\n      this.savingsService.getBalance().subscribe();\n      return operation;\n    }), catchError(error => {\n      this.notifyService.showError(error.error.message);\n      throw error;\n    }));\n  }\n  findAll(options) {\n    return this.http.get(this.url, {\n      params: {\n        ...options,\n        filter: JSON.stringify(options.filter)\n      }\n    }).pipe(catchError(error => {\n      this.notifyService.showError(error.error.message);\n      throw error;\n    }));\n  }\n  update(dto) {\n    return this.http.put(this.url, dto).pipe(map(() => {\n      this.notifyService.showSuccess('Operation successfully updated');\n      this.savingsService.getBalance().subscribe();\n    }), catchError(error => {\n      this.notifyService.showError(error.error.message);\n      throw error;\n    }));\n  }\n  delete(id) {\n    return this.http.delete(this.url, {\n      params: {\n        id\n      }\n    }).pipe(map(() => {\n      this.notifyService.showSuccess('Operation successfully deleted');\n      this.savingsService.getBalance().subscribe();\n    }), catchError(error => {\n      this.notifyService.showError(error.error.message);\n      throw error;\n    }));\n  }\n}\nOperationsService.ɵfac = function OperationsService_Factory(t) {\n  return new (t || OperationsService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.SavingsService), i0.ɵɵinject(i3.NotifyService));\n};\nOperationsService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: OperationsService,\n  factory: OperationsService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"AAGA,SAASA,UAAU,EAAEC,GAAG,QAAQ,gBAAgB;AAEhD,SAASC,WAAW,QAAQ,8BAA8B;;;;;AAW1D,OAAM,MAAOC,iBAAiB;EAG1BC,YACYC,IAAgB,EAChBC,cAA8B,EAC9BC,aAA4B;IAF5B,SAAI,GAAJF,IAAI;IACJ,mBAAc,GAAdC,cAAc;IACd,kBAAa,GAAbC,aAAa;IALR,QAAG,GAAGL,WAAW,CAACM,MAAM,GAAG,aAAa;EAMrD;EAEJC,MAAM,CAACC,SAA0B;IAC7B,OAAO,IAAI,CAACL,IAAI,CAACM,IAAI,CAAY,IAAI,CAACC,GAAG,EAAEF,SAAS,CAAC,CAACG,IAAI,CACtDZ,GAAG,CAACS,SAAS,IAAG;MACZ,IAAI,CAACH,aAAa,CAACO,WAAW,CAAC,gCAAgC,CAAC;MAChE,IAAI,CAACR,cAAc,CAACS,UAAU,EAAE,CAACC,SAAS,EAAE;MAC5C,OAAON,SAAS;IACpB,CAAC,CAAC,EACFV,UAAU,CAACiB,KAAK,IAAG;MACf,IAAI,CAACV,aAAa,CAACW,SAAS,CAACD,KAAK,CAACA,KAAK,CAACE,OAAO,CAAC;MACjD,MAAMF,KAAK;IACf,CAAC,CAAC,CACL;EACL;EAEAG,OAAO,CAACC,OAAuB;IAC3B,OAAO,IAAI,CAAChB,IAAI,CAACiB,GAAG,CAAuC,IAAI,CAACV,GAAG,EAAE;MACjEW,MAAM,EAAE;QACJ,GAAGF,OAAO;QACVG,MAAM,EAAEC,IAAI,CAACC,SAAS,CAACL,OAAO,CAACG,MAAM;;KAE5C,CAAC,CAACX,IAAI,CACHb,UAAU,CAACiB,KAAK,IAAG;MACf,IAAI,CAACV,aAAa,CAACW,SAAS,CAACD,KAAK,CAACA,KAAK,CAACE,OAAO,CAAC;MACjD,MAAMF,KAAK;IACf,CAAC,CAAC,CACL;EACL;EAGAU,MAAM,CAACC,GAAoB;IACvB,OAAO,IAAI,CAACvB,IAAI,CAACwB,GAAG,CAAO,IAAI,CAACjB,GAAG,EAAEgB,GAAG,CAAC,CAACf,IAAI,CAC1CZ,GAAG,CAAC,MAAK;MACL,IAAI,CAACM,aAAa,CAACO,WAAW,CAAC,gCAAgC,CAAC;MAChE,IAAI,CAACR,cAAc,CAACS,UAAU,EAAE,CAACC,SAAS,EAAE;IAChD,CAAC,CAAC,EACFhB,UAAU,CAACiB,KAAK,IAAG;MACf,IAAI,CAACV,aAAa,CAACW,SAAS,CAACD,KAAK,CAACA,KAAK,CAACE,OAAO,CAAC;MACjD,MAAMF,KAAK;IACf,CAAC,CAAC,CACL;EACL;EAEAa,MAAM,CAACC,EAAU;IACb,OAAO,IAAI,CAAC1B,IAAI,CAACyB,MAAM,CAAO,IAAI,CAAClB,GAAG,EAAE;MACpCW,MAAM,EAAE;QAAEQ;MAAE;KACf,CAAC,CAAClB,IAAI,CACHZ,GAAG,CAAC,MAAK;MACL,IAAI,CAACM,aAAa,CAACO,WAAW,CAAC,gCAAgC,CAAC;MAChE,IAAI,CAACR,cAAc,CAACS,UAAU,EAAE,CAACC,SAAS,EAAE;IAChD,CAAC,CAAC,EACFhB,UAAU,CAACiB,KAAK,IAAG;MACf,IAAI,CAACV,aAAa,CAACW,SAAS,CAACD,KAAK,CAACA,KAAK,CAACE,OAAO,CAAC;MACjD,MAAMF,KAAK;IACf,CAAC,CAAC,CACL;EACL;;AAhESd,iBAAiB;mBAAjBA,iBAAiB;AAAA;AAAjBA,iBAAiB;SAAjBA,iBAAiB;EAAA6B,SAAjB7B,iBAAiB;EAAA8B,YAFd;AAAM","names":["catchError","map","environment","OperationsService","constructor","http","savingsService","notifyService","apiUrl","create","operation","post","url","pipe","showSuccess","getBalance","subscribe","error","showError","message","findAll","options","get","params","filter","JSON","stringify","update","dto","put","delete","id","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\dh123\\OneDrive\\Рабочий стол\\Новая папка (8)\\client\\src\\app\\modules\\operations\\operations.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\n\nimport { environment } from 'src/environments/environment'; \nimport { NotifyService } from 'src/app/shared/services/notify.service';\nimport { SavingsService } from '../savings/savings.service';\nimport { CreateOperation } from './interfaces/create-operation.interface';\nimport { UpdateOperation } from './interfaces/update-operation.interface';\nimport { Operation } from './interfaces/operation.interface';\nimport { FindOperations } from './interfaces/find-operations.interface';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class OperationsService {\n    private readonly url = environment.apiUrl + 'operations/';\n    \n    constructor(\n        private http: HttpClient,\n        private savingsService: SavingsService,\n        private notifyService: NotifyService,\n    ) { }\n \n    create(operation: CreateOperation): Observable<Operation> {\n        return this.http.post<Operation>(this.url, operation).pipe(\n            map(operation => {\n                this.notifyService.showSuccess('Operation successfully created');\n                this.savingsService.getBalance().subscribe();\n                return operation;\n            }),\n            catchError(error => {\n                this.notifyService.showError(error.error.message);\n                throw error;\n            })\n        );\n    }\n\n    findAll(options: FindOperations): Observable<{ count: number, rows: Operation[] }> {\n        return this.http.get<{ count: number, rows: Operation[] }>(this.url, {\n            params: {\n                ...options,\n                filter: JSON.stringify(options.filter)\n            }\n        }).pipe(\n            catchError(error => {\n                this.notifyService.showError(error.error.message);\n                throw error;\n            })\n        );\n    }\n\n\n    update(dto: UpdateOperation): Observable<void> {\n        return this.http.put<void>(this.url, dto).pipe(\n            map(() => {\n                this.notifyService.showSuccess('Operation successfully updated');\n                this.savingsService.getBalance().subscribe();\n            }), \n            catchError(error => {\n                this.notifyService.showError(error.error.message);\n                throw error;\n            })\n        );\n    }\n\n    delete(id: number) {\n        return this.http.delete<void>(this.url, {\n            params: { id }\n        }).pipe(\n            map(() => {\n                this.notifyService.showSuccess('Operation successfully deleted');\n                this.savingsService.getBalance().subscribe();\n            }),\n            catchError(error => {\n                this.notifyService.showError(error.error.message);\n                throw error;\n            })\n        );\n    }\n}"]},"metadata":{},"sourceType":"module","externalDependencies":[]}