{"ast":null,"code":"import { OperationType } from '../../enums/operation-type.enum';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../operations.service\";\nimport * as i2 from \"src/app/modules/categories/category.service\";\nimport * as i3 from \"src/app/modules/savings/saving.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../../../../shared/components/paginator/paginator.component\";\nimport * as i6 from \"../../components/operation-filter/operation-filter.component\";\nimport * as i7 from \"../../components/operation-list/operation-list.component\";\nfunction OperationsPage_app_create_operation_modal_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-create-operation-modal\", 8);\n    i0.ɵɵlistener(\"createdOperation\", function OperationsPage_app_create_operation_modal_8_Template_app_create_operation_modal_createdOperation_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r3.addToOperations($event));\n    })(\"close\", function OperationsPage_app_create_operation_modal_8_Template_app_create_operation_modal_close_0_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.disableCreateMode());\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"types\", ctx_r0.types)(\"categories\", ctx_r0.categories)(\"savings\", ctx_r0.savings);\n  }\n}\nfunction OperationsPage_app_update_operation_modal_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-update-operation-modal\", 9);\n    i0.ɵɵlistener(\"updatedOperation\", function OperationsPage_app_update_operation_modal_9_Template_app_update_operation_modal_updatedOperation_0_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.replaceOperation($event));\n    })(\"close\", function OperationsPage_app_update_operation_modal_9_Template_app_update_operation_modal_close_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.disableEditMode());\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"operation\", ctx_r1.operationToUpdate)(\"types\", ctx_r1.types)(\"categories\", ctx_r1.categories)(\"savings\", ctx_r1.savings);\n  }\n}\nfunction OperationsPage_app_delete_operation_modal_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-delete-operation-modal\", 10);\n    i0.ɵɵlistener(\"remove\", function OperationsPage_app_delete_operation_modal_10_Template_app_delete_operation_modal_remove_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.removeOperation());\n    })(\"close\", function OperationsPage_app_delete_operation_modal_10_Template_app_delete_operation_modal_close_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.disableDeleteMode());\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"operation\", ctx_r2.operationToDelete);\n  }\n}\nexport class OperationsPage {\n  constructor(operationsService, categoryService, savingService) {\n    this.operationsService = operationsService;\n    this.categoryService = categoryService;\n    this.savingService = savingService;\n    this.operations = [];\n    this.types = Object.values(OperationType);\n    this.categories = [];\n    this.savings = [];\n    this.filter = {};\n    this.operationsLength = 0;\n    this.pageIndex = 1;\n    this.pageSize = 5;\n    this.pageSizeOptions = [5, 10, 25, 100];\n    this.visiblePagesRange = 5;\n    this.createMode = false;\n    this.editMode = false;\n    this.deleteMode = false;\n    this.operationToCreate = null;\n    this.operationToUpdate = null;\n    this.operationToDelete = null;\n  }\n  applyFilter(filter) {\n    this.filter = filter;\n    this.findOperations();\n  }\n  applyPage(event) {\n    this.pageIndex = event.pageIndex;\n    this.pageSize = event.pageSize;\n    this.findOperations();\n  }\n  findOperations() {\n    this.operationsService.findAll({\n      page: this.pageIndex,\n      limit: this.pageSize,\n      filter: this.filter\n    }).subscribe(data => {\n      this.operations = data.rows;\n      this.operationsLength = data.count;\n    });\n  }\n  createOperation() {\n    this.operationService.create(operationToCreate).subscribe(operation => {\n      this.createdOperation.emit(operation);\n      this.close.emit();\n    }, err => console.error(err.error.message));\n  }\n  addToOperations(operation) {\n    this.operations.unshift(operation);\n  }\n  replaceOperation(operation) {\n    const operationToUpdate = this.operations.find(item => item.id === operation.id);\n    const index = this.operations.indexOf(operationToUpdate);\n    this.operations.splice(index, 1, operation);\n  }\n  removeOperation() {\n    this.operations = this.operations.filter(operation => operation.id !== this.operationToDelete.id);\n    this.operationsLength--;\n  }\n  enableCreateMode() {\n    this.createMode = true;\n  }\n  disableCreateMode() {\n    this.createMode = false;\n  }\n  enableEditMode(operation) {\n    this.editMode = true;\n    this.operationToUpdate = JSON.parse(JSON.stringify(operation));\n  }\n  disableEditMode() {\n    this.editMode = false;\n    this.operationToUpdate = null;\n  }\n  enableDeleteMode(operation) {\n    this.deleteMode = true;\n    this.operationToDelete = JSON.parse(JSON.stringify(operation));\n  }\n  disableDeleteMode() {\n    this.deleteMode = false;\n    this.operationToDelete = null;\n  }\n  ngOnInit() {\n    this.findOperations();\n    this.savingService.get().subscribe(data => this.savings = data, err => console.error(err.error.message));\n    this.categoryService.get().subscribe(data => this.categories = data, err => console.error(err.error.message));\n  }\n}\nOperationsPage.ɵfac = function OperationsPage_Factory(t) {\n  return new (t || OperationsPage)(i0.ɵɵdirectiveInject(i1.OperationsService), i0.ɵɵdirectiveInject(i2.CategoryService), i0.ɵɵdirectiveInject(i3.SavingService));\n};\nOperationsPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: OperationsPage,\n  selectors: [[\"app-operations\"]],\n  decls: 11,\n  vars: 12,\n  consts: [[1, \"container\"], [1, \"create-button\", 3, \"click\"], [3, \"types\", \"categories\", \"savings\", \"applyFilter\"], [3, \"operations\", \"operationToEdit\", \"operationToDelete\"], [3, \"pageIndex\", \"length\", \"pageSize\", \"pageSizeOptions\", \"visiblePagesRange\", \"page\"], [3, \"types\", \"categories\", \"savings\", \"createdOperation\", \"close\", 4, \"ngIf\"], [3, \"operation\", \"types\", \"categories\", \"savings\", \"updatedOperation\", \"close\", 4, \"ngIf\"], [3, \"operation\", \"remove\", \"close\", 4, \"ngIf\"], [3, \"types\", \"categories\", \"savings\", \"createdOperation\", \"close\"], [3, \"operation\", \"types\", \"categories\", \"savings\", \"updatedOperation\", \"close\"], [3, \"operation\", \"remove\", \"close\"]],\n  template: function OperationsPage_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n      i0.ɵɵtext(2, \"Operations\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"button\", 1);\n      i0.ɵɵlistener(\"click\", function OperationsPage_Template_button_click_3_listener() {\n        return ctx.enableCreateMode();\n      });\n      i0.ɵɵtext(4, \" Create \");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(5, \"app-operation-filter\", 2);\n      i0.ɵɵlistener(\"applyFilter\", function OperationsPage_Template_app_operation_filter_applyFilter_5_listener($event) {\n        return ctx.applyFilter($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(6, \"app-operation-list\", 3);\n      i0.ɵɵlistener(\"operationToEdit\", function OperationsPage_Template_app_operation_list_operationToEdit_6_listener($event) {\n        return ctx.enableEditMode($event);\n      })(\"operationToDelete\", function OperationsPage_Template_app_operation_list_operationToDelete_6_listener($event) {\n        return ctx.enableDeleteMode($event);\n      });\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"app-paginator\", 4);\n      i0.ɵɵlistener(\"page\", function OperationsPage_Template_app_paginator_page_7_listener($event) {\n        return ctx.applyPage($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(8, OperationsPage_app_create_operation_modal_8_Template, 1, 3, \"app-create-operation-modal\", 5);\n      i0.ɵɵtemplate(9, OperationsPage_app_update_operation_modal_9_Template, 1, 4, \"app-update-operation-modal\", 6);\n      i0.ɵɵtemplate(10, OperationsPage_app_delete_operation_modal_10_Template, 1, 1, \"app-delete-operation-modal\", 7);\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(5);\n      i0.ɵɵproperty(\"types\", ctx.types)(\"categories\", ctx.categories)(\"savings\", ctx.savings);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"operations\", ctx.operations);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"pageIndex\", ctx.pageIndex)(\"length\", ctx.operationsLength)(\"pageSize\", ctx.pageSize)(\"pageSizeOptions\", ctx.pageSizeOptions)(\"visiblePagesRange\", ctx.visiblePagesRange);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.createMode);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.editMode);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.deleteMode);\n    }\n  },\n  dependencies: [i4.NgIf, i5.PaginatorComponent, i6.OperationFilterComponent, i7.OperationListComponent],\n  styles: [\".container[_ngcontent-%COMP%] {\\n  position: relative;\\n  width: 1050px;\\n  margin: 0 auto;\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n}\\n.container[_ngcontent-%COMP%]   .create-button[_ngcontent-%COMP%] {\\n  position: absolute;\\n  top: 25px;\\n  right: 0;\\n  height: 30px;\\n}\\n\\nh2[_ngcontent-%COMP%] {\\n  margin-top: 20px;\\n  text-align: center;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvbW9kdWxlcy9vcGVyYXRpb25zL3BhZ2VzL29wZXJhdGlvbnMvb3BlcmF0aW9ucy5wYWdlLnNjc3MiLCJ3ZWJwYWNrOi8vLi8uLi8uLi8uLi8lRDAlQTAlRDAlQjAlRDAlQjElRDAlQkUlRDElODclRDAlQjglRDAlQjklMjAlRDElODElRDElODIlRDAlQkUlRDAlQkIvJUQwJTlEJUQwJUJFJUQwJUIyJUQwJUIwJUQxJThGJTIwJUQwJUJGJUQwJUIwJUQwJUJGJUQwJUJBJUQwJUIwJTIwKDgpL2NsaWVudC9zcmMvYXBwL21vZHVsZXMvb3BlcmF0aW9ucy9wYWdlcy9vcGVyYXRpb25zL29wZXJhdGlvbnMucGFnZS5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksa0JBQUE7RUFDQSxhQUFBO0VBQ0EsY0FBQTtFQUNBLGFBQUE7RUFDQSxzQkFBQTtFQUNBLHVCQUFBO0FDQ0o7QURDSTtFQUNJLGtCQUFBO0VBQ0EsU0FBQTtFQUNBLFFBQUE7RUFDQSxZQUFBO0FDQ1I7O0FER0E7RUFDSSxnQkFBQTtFQUNBLGtCQUFBO0FDQUoiLCJzb3VyY2VzQ29udGVudCI6WyIuY29udGFpbmVyIHtcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgd2lkdGg6IDEwNTBweDtcbiAgICBtYXJnaW46IDAgYXV0bztcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG5cbiAgICAmIC5jcmVhdGUtYnV0dG9uIHtcbiAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgICB0b3A6IDI1cHg7XG4gICAgICAgIHJpZ2h0OiAwO1xuICAgICAgICBoZWlnaHQ6IDMwcHg7XG4gICAgfVxufVxuXG5oMiB7XG4gICAgbWFyZ2luLXRvcDogMjBweDtcbiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XG59IiwiLmNvbnRhaW5lciB7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgd2lkdGg6IDEwNTBweDtcbiAgbWFyZ2luOiAwIGF1dG87XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIGp1c3RpZnktY29udGVudDogY2VudGVyO1xufVxuLmNvbnRhaW5lciAuY3JlYXRlLWJ1dHRvbiB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgdG9wOiAyNXB4O1xuICByaWdodDogMDtcbiAgaGVpZ2h0OiAzMHB4O1xufVxuXG5oMiB7XG4gIG1hcmdpbi10b3A6IDIwcHg7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["OperationType","i0","OperationsPage","constructor","operationsService","categoryService","savingService","Object","values","applyFilter","filter","findOperations","applyPage","event","pageIndex","pageSize","findAll","page","limit","subscribe","data","operations","rows","operationsLength","count","createOperation","operationService","create","operationToCreate","operation","createdOperation","emit","close","err","console","error","message","addToOperations","unshift","replaceOperation","operationToUpdate","find","item","id","index","indexOf","splice","removeOperation","operationToDelete","enableCreateMode","createMode","disableCreateMode","enableEditMode","editMode","JSON","parse","stringify","disableEditMode","enableDeleteMode","deleteMode","disableDeleteMode","ngOnInit","get","savings","categories","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\dh123\\OneDrive\\Рабочий стол\\Новая папка (8)\\client\\src\\app\\modules\\operations\\pages\\operations\\operations.page.ts","C:\\Users\\dh123\\OneDrive\\Рабочий стол\\Новая папка (8)\\client\\src\\app\\modules\\operations\\pages\\operations\\operations.page.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\n\nimport { OperationsService } from '../../operations.service';\nimport { SavingService } from 'src/app/modules/savings/saving.service';\nimport { CategoryService } from 'src/app/modules/categories/category.service';\nimport { Operation } from '../../operation.model';\nimport { OperationType } from '../../enums/operation-type.enum';\nimport { Saving } from 'src/app/modules/savings/saving.model';\nimport { Category } from 'src/app/modules/categories/category.model';\nimport { OperationFilterDto } from '../../dto/operation.filter.dto';\nimport { PageEvent } from 'src/app/shared/interfaces/page-event.interface';\n\n@Component({\n  selector: 'app-operations',\n  templateUrl: './operations.page.html',\n  styleUrls: ['./operations.page.scss']\n})\nexport class OperationsPage implements OnInit {\n    operations: Operation[] = [];\n    types: OperationType[] = Object.values(OperationType);\n    categories: Category[] = [];\n    savings: Saving[] = [];\n    \n    filter: OperationFilterDto = {};\n\n    operationsLength = 0;\n    pageIndex = 1;\n    pageSize = 5;\n    pageSizeOptions: number[] = [5, 10, 25, 100];\n    visiblePagesRange = 5;\n    \n    createMode = false;\n    editMode = false;\n    deleteMode = false;\n    operationToCreate: Operation | null = null;\n    operationToUpdate: Operation | null = null;\n    operationToDelete: Operation | null = null;\n\n    constructor(\n        private operationsService: OperationsService,\n        private categoryService: CategoryService,\n        private savingService: SavingService\n    ) { }\n\n    applyFilter(filter: OperationFilterDto) {\n        this.filter = filter;\n        this.findOperations();\n    }\n\n    applyPage(event: PageEvent) {\n        this.pageIndex = event.pageIndex;\n        this.pageSize = event.pageSize;\n        this.findOperations();\n    }\n\n    findOperations() {\n        this.operationsService.findAll({\n            page: this.pageIndex,\n            limit: this.pageSize,\n            filter: this.filter\n        }).subscribe(\n            data => {\n                this.operations = data.rows;\n                this.operationsLength = data.count;\n            }\n        );\n    }\n\n    createOperation() {\n        this.operationService.create(operationToCreate).subscribe(\n            operation => {\n                this.createdOperation.emit(operation);\n                this.close.emit();\n            },\n            err => console.error(err.error.message)\n        );\n    }\n\n    addToOperations(operation: Operation) {\n        this.operations.unshift(operation);\n    }\n\n    replaceOperation(operation: Operation) {\n        const operationToUpdate = this.operations.find(item => item.id === operation.id)!;\n        const index = this.operations.indexOf(operationToUpdate);\n        this.operations.splice(index, 1, operation);\n    }\n\n    removeOperation() {\n        this.operations = this.operations.filter(operation =>\n            operation.id !== this.operationToDelete!.id);\n        this.operationsLength--;\n    }\n\n    enableCreateMode() {\n        this.createMode = true;\n    }\n\n    disableCreateMode() {\n        this.createMode = false;\n    }\n\n    enableEditMode(operation: Operation): void {\n        this.editMode = true;\n        this.operationToUpdate = JSON.parse(JSON.stringify(operation));\n    }\n\n    disableEditMode(): void {\n        this.editMode = false;\n        this.operationToUpdate = null;\n    }\n    \n    enableDeleteMode(operation: Operation): void {\n        this.deleteMode = true;\n        this.operationToDelete = JSON.parse(JSON.stringify(operation));\n    }\n\n    disableDeleteMode(): void {\n        this.deleteMode = false;\n        this.operationToDelete = null;\n    }\n\n    ngOnInit(): void {\n        this.findOperations();\n\n        this.savingService.get().subscribe(\n            data => this.savings = data,\n            err => console.error(err.error.message)\n        );\n        \n        this.categoryService.get().subscribe(\n            data => this.categories = data,\n            err => console.error(err.error.message)\n        );\n    }\n}","<div class=\"container\">\n    <h2>Operations</h2>\n\n    <button\n        class=\"create-button\"\n        (click)=\"enableCreateMode()\">\n        Create\n    </button>\n\n    <app-operation-filter\n        [types]=\"types\"\n        [categories]=\"categories\"\n        [savings]=\"savings\"\n        (applyFilter)=\"applyFilter($event)\">\n    </app-operation-filter>\n\n    <app-operation-list\n        [operations]=\"operations\"\n        (operationToEdit)=\"enableEditMode($event)\"\n        (operationToDelete)=\"enableDeleteMode($event)\">\n    </app-operation-list>\n\n    <app-paginator\n        [pageIndex]=\"pageIndex\"\n        [length]=\"operationsLength\"\n        [pageSize]=\"pageSize\"\n        [pageSizeOptions]=\"pageSizeOptions\"\n        [visiblePagesRange]=\"visiblePagesRange\"\n        (page)=\"applyPage($event)\">\n    </app-paginator>\n</div>\n\n<app-create-operation-modal\n    *ngIf=\"createMode\"\n    [types]=\"types\"\n    [categories]=\"categories\"\n    [savings]=\"savings\"\n    (createdOperation)=\"addToOperations($event)\"\n    (close)=\"disableCreateMode()\">\n</app-create-operation-modal>\n\n<app-update-operation-modal\n    *ngIf=\"editMode\"\n    [operation]=\"operationToUpdate!\"\n    [types]=\"types\"\n    [categories]=\"categories\"\n    [savings]=\"savings\"\n    (updatedOperation)=\"replaceOperation($event)\"\n    (close)=\"disableEditMode()\">\n</app-update-operation-modal>\n\n<app-delete-operation-modal\n    *ngIf=\"deleteMode\"\n    [operation]=\"operationToDelete!\"\n    (remove)=\"removeOperation()\"\n    (close)=\"disableDeleteMode()\">\n</app-delete-operation-modal>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}